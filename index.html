<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OA: Energ√≠a E√≥lica - Ingenier√≠a</title>
    <style>
        /* =========================================
           PRINCIPIOS CARP & SE√ëALIZACI√ìN (MAYER)
           ========================================= */
        :root {
            --fondo: #F4F7F6;
            --titulos: #1F3A5F;
            --texto-base: #333333;
            --gris-claro: #F8FAFA;
            --borde: #E0E0E0;
            
            --color-v: #0288D1;
            --color-rho: #388E3C;
            --color-d: #F57C00;
            --color-p: #D32F2F;
            --color-betz: #7B1FA2;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: "Open Sans", "Segoe UI", Arial, sans-serif;
            background-color: var(--fondo);
            color: var(--texto-base);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        #main-container {
            max-width: 1000px;
            margin: 0 auto;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            width: 100%;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.08);
        }

        header {
            padding: 1.5rem 2rem;
            border-bottom: 2px solid var(--borde);
            background: white;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .indicador { font-weight: bold; color: var(--titulos); font-size: 1.2rem; }

        .tabs { display: flex; gap: 0.5rem; overflow-x: auto; padding-bottom: 0.5rem;}
        .tab-btn {
            padding: 0.6rem 1.2rem;
            background: var(--gris-claro);
            border: 1px solid var(--borde);
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            color: #555;
            transition: all 0.2s;
            white-space: nowrap;
        }
        .tab-btn:hover { background: #E0E0E0; }
        .tab-btn.active-tab { background: var(--titulos); color: white; border-color: var(--titulos); }

        .screen { display: none; padding: 2.5rem 2rem; flex-grow: 1; }
        .screen.active { display: block; animation: fadeIn 0.4s ease-out; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h1, h2, h3 { color: var(--titulos); margin-bottom: 1rem; }
        h1 { font-size: 2.2rem; border-bottom: 3px solid var(--borde); padding-bottom: 0.5rem; margin-bottom: 2rem; }
        h2 { font-size: 1.5rem; margin-top: 1.5rem; }
        
        .var-v { color: var(--color-v); font-weight: bold; }
        .var-rho { color: var(--color-rho); font-weight: bold; }
        .var-d { color: var(--color-d); font-weight: bold; }
        .var-p { color: var(--color-p); font-weight: bold; }
        .var-betz { color: var(--color-betz); font-weight: bold; }

        .btn-accion {
            padding: 0.8rem 1.8rem; font-size: 1rem; font-weight: bold; cursor: pointer;
            border: none; border-radius: 4px; transition: all 0.2s; text-align: center;
        }
        .btn-primario { background-color: var(--titulos); color: white; }
        .btn-primario:hover { background-color: #122238; transform: translateY(-2px); }
        .btn-siguiente { background-color: #E3F2FD; color: var(--titulos); border: 1px solid var(--color-v); display: inline-block; margin-top: 1rem;}
        .btn-siguiente:hover { background-color: #BBDEFB; }
        .btn-continuar { background-color: #4CAF50; color: white; display: inline-block; margin-top: 2rem;}
        .btn-continuar:hover { background-color: #388E3C; transform: translateY(-2px); }

        /* Pantalla 1 */
        .portada-hero { text-align: center; margin-bottom: 2.5rem; }
        .portada-title { font-size: 3rem; color: var(--titulos); margin-bottom: 0.5rem; border: none; }
        
        .caja-diagnostico {
            background: var(--gris-claro); padding: 2rem; border-radius: 8px; 
            border-left: 5px solid var(--color-v); margin-bottom: 2rem;
            border: 1px solid var(--borde); border-left-width: 5px;
        }
        .pregunta-diag { margin-bottom: 1.5rem; }
        .pregunta-diag p { font-weight: bold; margin-bottom: 0.8rem; font-size: 1.1rem; }
        .opciones-diag { display: flex; flex-direction: column; gap: 0.5rem; }
        .opt-btn {
            text-align: left; padding: 0.8rem 1rem; border: 1px solid var(--borde);
            background: white; border-radius: 4px; cursor: pointer; font-size: 1rem; transition: 0.2s;
        }
        .opt-btn:hover { background: #F0F0F0; }
        .feedback-inline { margin-top: 0.5rem; font-size: 0.95rem; font-weight: bold; display: none; padding: 0.5rem; border-radius: 4px;}
        .fb-correcto { background: #E8F5E9; color: #2E7D32; border-left: 4px solid #4CAF50;}
        .fb-incorrecto { background: #FFEBEE; color: #C62828; border-left: 4px solid #F44336;}

        /* Pantalla 2 */
        .segmented-block {
            display: none;
            background: white; padding: 2rem; border-radius: 8px; margin-bottom: 2rem;
            border: 1px solid var(--borde); box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        }
        .segmented-block.visible { display: block; animation: fadeIn 0.5s ease-out; }
        
        .concepto-fisico {
            background: var(--gris-claro); padding: 1.5rem; border-radius: 6px; margin-bottom: 1rem;
            border: 1px solid var(--borde); border-left-width: 4px;
            display: flex; align-items: center; gap: 1.5rem;
        }
        .concepto-fisico h3 { margin-top: 0; margin-bottom: 0.5rem; font-size: 1.2rem; }
        .concepto-icono { flex-shrink: 0; width: 80px; height: 80px; display: flex; justify-content: center; align-items: center; background: white; border-radius: 50%; border: 1px solid var(--borde); box-shadow: 0 2px 4px rgba(0,0,0,0.05);}
        .concepto-texto { flex-grow: 1; }

        .formula-container {
            display: flex; align-items: center; justify-content: center; gap: 2rem;
            background: var(--gris-claro); padding: 1.5rem; border-radius: 8px; margin: 1.5rem 0;
            flex-wrap: wrap; border: 1px solid var(--borde);
        }
        .formula-destacada { font-size: 2.2rem; font-family: "Georgia", serif; font-weight: bold; }
        .formula-leyenda { font-size: 1rem; max-width: 300px; color: #555; }

        /* Pantalla 3 */
        .controls-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; }
        .control-item { background: var(--gris-claro); padding: 1.2rem; border-radius: 6px; text-align: center; border: 1px solid var(--borde); border-top-width: 4px;}
        .control-item label { display: block; font-weight: bold; margin-bottom: 0.8rem; font-size: 1.05rem; }
        input[type="range"] { width: 100%; cursor: pointer; height: 6px; }
        
        .feedback-dinamico {
            background: #E3F2FD; border-left: 5px solid var(--color-v); padding: 1rem 1.5rem;
            margin: 1.5rem 0; border-radius: 4px; font-weight: bold; color: #1565C0;
            display: flex; align-items: center; gap: 10px; min-height: 60px; transition: all 0.3s;
        }

        .outputs-container { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin: 2rem 0; }
        .output-card { padding: 1.5rem; text-align: center; border-radius: 6px; border: 1px solid var(--borde); }
        .out-p { background: #FFEBEE; border-top: 5px solid var(--color-p); }
        .out-betz { background: #F3E5F5; border-top: 5px solid var(--color-betz); }
        .val-gigante { font-size: 2.5rem; font-weight: bold; }

        .visualizer {
            background: #FAFAFA; height: 350px; width: 100%; border-radius: 8px; 
            border: 1px solid var(--borde); position: relative; overflow: hidden;
            display: flex; justify-content: center; align-items: flex-end;
        }

        table { width: 100%; border-collapse: collapse; margin-top: 1rem; background: white; }
        th, td { border: 1px solid var(--borde); padding: 0.8rem; text-align: center; }
        th { background: var(--gris-claro); }
        
        .active-learning-box {
            background: #FFF8E1; border: 1px solid #FFE082; padding: 2rem; 
            border-radius: 8px; margin-top: 2rem;
        }

        /* Pantalla 4 */
        .resumen-box {
            background: #E8F5E9; border: 1px solid #C8E6C9; padding: 2rem;
            border-radius: 8px; margin-bottom: 2rem;
        }
        .resumen-box ul { margin-left: 2rem; margin-top: 1rem; line-height: 1.8; }
        .resumen-box li { margin-bottom: 0.5rem; }

        /* Pantalla 5 */
        .meta-box { background: var(--gris-claro); padding: 1.5rem; border-radius: 6px; margin-bottom: 1.5rem; border: 1px solid var(--borde); border-left: 4px solid var(--titulos);}

        /* Footer */
        footer {
            text-align: center;
            padding: 1rem;
            color: #777;
            font-size: 0.75rem; /* Letra peque√±a */
            border-top: 1px solid var(--borde);
            background: var(--gris-claro);
            margin-top: auto;
        }

        @media (max-width: 768px) { 
            .controls-grid, .outputs-container { grid-template-columns: 1fr; }
            .formula-container { flex-direction: column; text-align: center; }
            .concepto-fisico { flex-direction: column; text-align: center; }
        }
    </style>
</head>
<body>

<div id="main-container">
    <header>
        <div class="header-top">
            <div class="indicador" id="progress">Paso 1 de 5</div>
        </div>
        <div class="tabs">
            <button class="tab-btn active-tab" id="tab-1" onclick="nav(1)">1. Inicio</button>
            <button class="tab-btn" id="tab-2" onclick="nav(2)">2. Teor√≠a F√≠sica</button>
            <button class="tab-btn" id="tab-3" onclick="nav(3)">3. Simulador</button>
            <button class="tab-btn" id="tab-4" onclick="nav(4)">4. Resumen</button>
            <button class="tab-btn" id="tab-5" onclick="nav(5)">5. Acerca del OA</button>
        </div>
    </header>

    <!-- PANTALLA 1: INICIO & ACTIVACI√ìN -->
    <section id="s1" class="screen active">
        <div class="portada-hero">
            <h1 class="portada-title">Energ√≠a E√≥lica</h1>
            <p style="font-size: 1.2rem; color: #555; max-width: 600px; margin: 0 auto 2rem auto;">Estimaci√≥n de potencia y par√°metros f√≠sicos determinantes.</p>
            
            <!-- ILUSTRACI√ìN HERO DE PORTADA CORREGIDA: Animaci√≥n anclada correctamente en la punta -->
            <svg viewBox="0 0 800 250" width="100%" height="auto" style="border-radius: 8px; margin-bottom: 2rem; background: linear-gradient(to bottom, #E3F2FD, #FFFFFF); box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid var(--borde);">
                <!-- Sol -->
                <circle cx="120" cy="80" r="35" fill="#FFE082" opacity="0.8"/>
                <!-- Nubes -->
                <path d="M 600 80 Q 620 60 640 80 Q 670 70 680 90 Q 700 90 700 110 L 580 110 Q 570 90 600 80 Z" fill="#FFFFFF" opacity="0.9"/>
                <path d="M 250 100 Q 270 80 290 100 Q 320 90 330 110 Q 350 110 350 130 L 230 130 Q 220 110 250 100 Z" fill="#FFFFFF" opacity="0.8"/>
                <!-- Suelo verde (Base) -->
                <path d="M 0 210 Q 200 190 400 210 T 800 200 L 800 250 L 0 250 Z" fill="#E8F5E9"/>
                
                <!-- Turbina Secundaria (Fondo) -->
                <g transform="translate(650, 210) scale(0.6)">
                    <!-- Torre (Base en el suelo y=0, punta en y=-120) -->
                    <polygon points="-12,0 12,0 3,-120 -3,-120" fill="#B0BEC5"/>
                    
                    <!-- Eje posicionado exactamente en la punta de la torre -->
                    <g transform="translate(0, -120)">
                        <!-- Animaci√≥n encapsulada para no perder la posici√≥n de la punta -->
                        <g>
                            <animateTransform attributeName="transform" type="rotate" from="0 0 0" to="360 0 0" dur="4s" repeatCount="indefinite" />
                            <path d="M -3,-5 Q -7,-30 0,-75 Q 7,-30 3,-5 Z" fill="#FAFAFA" stroke="#CFD8DC" stroke-width="1"/>
                            <path d="M -3,-5 Q -7,-30 0,-75 Q 7,-30 3,-5 Z" fill="#FAFAFA" stroke="#CFD8DC" stroke-width="1" transform="rotate(120)"/>
                            <path d="M -3,-5 Q -7,-30 0,-75 Q 7,-30 3,-5 Z" fill="#FAFAFA" stroke="#CFD8DC" stroke-width="1" transform="rotate(240)"/>
                        </g>
                        <!-- Rotor central sobre las aspas -->
                        <circle cx="0" cy="0" r="6" fill="#78909C"/>
                    </g>
                </g>

                <!-- Turbina Principal (Frente) -->
                <g transform="translate(400, 215)">
                    <!-- Torre (Base en el suelo y=0, punta en y=-140) -->
                    <polygon points="-16,0 16,0 4,-140 -4,-140" fill="#90A4AE"/>
                    
                    <!-- Eje posicionado exactamente en la punta de la torre -->
                    <g transform="translate(0, -140)">
                        <!-- Animaci√≥n encapsulada para girar anclado a la punta -->
                        <g>
                            <animateTransform attributeName="transform" type="rotate" from="0 0 0" to="360 0 0" dur="2s" repeatCount="indefinite" />
                            <path d="M -4,-6 Q -9,-35 0,-90 Q 9,-35 4,-6 Z" fill="#FFFFFF" stroke="#ECEFF1" stroke-width="1"/>
                            <path d="M -4,-6 Q -9,-35 0,-90 Q 9,-35 4,-6 Z" fill="#FFFFFF" stroke="#ECEFF1" stroke-width="1" transform="rotate(120)"/>
                            <path d="M -4,-6 Q -9,-35 0,-90 Q 9,-35 4,-6 Z" fill="#FFFFFF" stroke="#ECEFF1" stroke-width="1" transform="rotate(240)"/>
                        </g>
                        <!-- Rotor central sobre las aspas -->
                        <circle cx="0" cy="0" r="8" fill="#546E7A"/>
                    </g>
                </g>

                <!-- L√≠neas de Viento Animadas -->
                <g stroke="#90CAF9" stroke-width="3" stroke-linecap="round" opacity="0.6">
                    <line x1="-100" y1="90" x2="-20" y2="90"><animate attributeName="x1" values="-100;900" dur="3s" repeatCount="indefinite"/><animate attributeName="x2" values="-20;980" dur="3s" repeatCount="indefinite"/></line>
                    <line x1="-200" y1="160" x2="-80" y2="160"><animate attributeName="x1" values="-200;800" dur="4.5s" repeatCount="indefinite"/><animate attributeName="x2" values="-80;920" dur="4.5s" repeatCount="indefinite"/></line>
                </g>
            </svg>
        </div>

        <div class="caja-diagnostico">
            <h2 style="margin-top: 0; display: flex; align-items: center; gap: 10px;">
                <span>üß†</span> Exploraci√≥n inicial
            </h2>
            <p style="margin-bottom: 1.5rem;">Antes de comenzar la teor√≠a, responde seg√∫n tu intuici√≥n. (No tiene calificaci√≥n).</p>

            <div class="pregunta-diag">
                <p>1. ¬øDe qu√© depende principalmente la potencia que podemos extraer del viento?</p>
                <div class="opciones-diag">
                    <button class="opt-btn" onclick="checkDiag(this, 1, false, 'Incorrecto. Aunque influyen, no son el factor principal.')">A) De la temperatura y la altitud exclusivamente.</button>
                    <button class="opt-btn" onclick="checkDiag(this, 1, true, '¬°Correcto! La velocidad es el factor m√°s determinante, como veremos en la f√≥rmula.')">B) De la velocidad del viento, la densidad del aire y el tama√±o de las aspas.</button>
                    <button class="opt-btn" onclick="checkDiag(this, 1, false, 'Incorrecto. El n√∫mero de aspas no es la variable fundamental para la potencia bruta.')">C) Del n√∫mero de aspas que tenga el generador.</button>
                </div>
                <div id="fb-diag-1" class="feedback-inline"></div>
            </div>

            <div class="pregunta-diag">
                <p>2. Si la velocidad del viento se duplica (por ejemplo, pasa de 5 m/s a 10 m/s), ¬øqu√© ocurre con la potencia generada?</p>
                <div class="opciones-diag">
                    <button class="opt-btn" onclick="checkDiag(this, 2, false, 'Incorrecto. La relaci√≥n no es lineal. Es mucho mayor.')">A) Se duplica (x2).</button>
                    <button class="opt-btn" onclick="checkDiag(this, 2, false, 'Incorrecto. Es un aumento grande, pero no se cuadruplica (eso pasa con el di√°metro).')">B) Se cuadruplica (x4).</button>
                    <button class="opt-btn" onclick="checkDiag(this, 2, true, '¬°Exacto! Al estar elevada al cubo en la ecuaci√≥n (2¬≥ = 8), la potencia se multiplica por ocho.')">C) Se multiplica por ocho (x8).</button>
                </div>
                <div id="fb-diag-2" class="feedback-inline"></div>
            </div>
        </div>
        
        <div style="text-align: right;">
            <button class="btn-accion btn-primario" onclick="nav(2)">Comenzar Teor√≠a ‚ûî</button>
        </div>
    </section>

    <!-- PANTALLA 2: TEOR√çA -->
    <section id="s2" class="screen">
        <h1>Fundamentos de Generaci√≥n E√≥lica</h1>
        <p style="margin-bottom: 1.5rem;">Haz clic en los botones para avanzar por los conceptos. Observa los colores asignados a cada variable, ya que se mantendr√°n durante todo el ejercicio.</p>

        <div class="segmented-block visible" id="bloque-1">
            <h2>1. Par√°metros F√≠sicos Determinantes</h2>
            <p>La cantidad de energ√≠a cin√©tica que el viento transfiere a un aerogenerador depende de tres variables f√≠sicas fundamentales. Entender c√≥mo se comportan es clave para el dise√±o e√≥lico.</p>
            
            <div class="concepto-fisico" style="border-left-color: var(--color-v);">
                <div class="concepto-icono">
                    <svg viewBox="0 0 100 100" width="50" height="50">
                        <g stroke="var(--color-v)" stroke-width="8" stroke-linecap="round" stroke-linejoin="round" fill="none">
                            <line x1="10" y1="30" x2="80" y2="30"/><polyline points="60,10 80,30 60,50"/>
                            <line x1="10" y1="70" x2="60" y2="70"/><polyline points="40,50 60,70 40,90"/>
                        </g>
                    </svg>
                </div>
                <div class="concepto-texto">
                    <h3 class="var-v">Velocidad del viento (v)</h3>
                    <p>Es el factor m√°s cr√≠tico e influyente. Representa qu√© tan r√°pido se desplazan las masas de aire. Al estar elevada al cubo en la ecuaci√≥n de potencia, peque√±as variaciones en la velocidad generan diferencias inmensas en la energ√≠a capturada.</p>
                </div>
            </div>

            <div class="concepto-fisico" style="border-left-color: var(--color-rho);">
                <div class="concepto-icono">
                    <svg viewBox="0 0 100 100" width="50" height="50">
                        <rect x="10" y="10" width="80" height="80" fill="rgba(56, 142, 60, 0.1)" stroke="var(--color-rho)" stroke-width="4" rx="8"/>
                        <g fill="var(--color-rho)">
                            <circle cx="30" cy="30" r="5"/><circle cx="70" cy="40" r="5"/><circle cx="40" cy="70" r="5"/>
                            <circle cx="80" cy="80" r="5"/><circle cx="50" cy="50" r="5"/><circle cx="20" cy="80" r="5"/>
                            <circle cx="80" cy="20" r="5"/><circle cx="20" cy="50" r="5"/><circle cx="60" cy="85" r="5"/>
                        </g>
                    </svg>
                </div>
                <div class="concepto-texto">
                    <h3 class="var-rho">Densidad del aire (œÅ)</h3>
                    <p>Representa la "pesadez" del aire. El aire fr√≠o y a nivel del mar es m√°s denso (tiene m√°s mol√©culas por metro c√∫bico) y "golpea" con m√°s fuerza. El aire c√°lido o en zonas de gran altitud es menos denso, reduciendo la potencia.</p>
                </div>
            </div>

            <div class="concepto-fisico" style="border-left-color: var(--color-d);">
                <div class="concepto-icono">
                    <svg viewBox="0 0 100 100" width="50" height="50">
                        <circle cx="50" cy="50" r="40" fill="rgba(245, 124, 0, 0.1)" stroke="var(--color-d)" stroke-width="4" stroke-dasharray="6 4"/>
                        <line x1="50" y1="50" x2="90" y2="50" stroke="var(--color-d)" stroke-width="4"/>
                        <circle cx="50" cy="50" r="6" fill="var(--color-d)"/>
                        <text x="65" y="45" fill="var(--color-d)" font-weight="bold" font-family="sans-serif" font-size="16">r</text>
                    </svg>
                </div>
                <div class="concepto-texto">
                    <h3 class="var-d">√Årea de barrido (A)</h3>
                    <p>Es la superficie circular que cubren las aspas al girar. Depende directamente del <span class="var-d">Di√°metro (D)</span> del rotor. Como el √°rea de un c√≠rculo es œÄ¬∑r¬≤, al duplicar la longitud de las aspas, el √°rea interceptada (y la potencia) se cuadruplican.</p>
                </div>
            </div>

            <button class="btn-accion btn-siguiente" onclick="reveal('bloque-2', this)">Siguiente: Modelo Matem√°tico ‚ûî</button>
        </div>

        <div class="segmented-block" id="bloque-2">
            <h2>2. Modelo Matem√°tico</h2>
            <p>Las tres variables anteriores se relacionan mediante la ecuaci√≥n fundamental de la potencia e√≥lica en flujo libre. Esta f√≥rmula describe la energ√≠a cin√©tica total contenida en el viento que pasa a trav√©s del √°rea de la turbina.</p>
            
            <div class="formula-container">
                <div class="formula-destacada">
                    <span class="var-p">P</span> = ¬Ω ¬∑ <span class="var-rho">œÅ</span> ¬∑ <span class="var-d">A</span> ¬∑ <span class="var-v">v¬≥</span>
                </div>
                <div class="formula-leyenda">
                    <strong>Donde:</strong><br>
                    <span class="var-p">P</span> = Potencia Te√≥rica (Vatios)<br>
                    <span class="var-rho">œÅ</span> = Densidad (kg/m¬≥)<br>
                    <span class="var-d">A</span> = √Årea (m¬≤) = œÄ¬∑(D/2)¬≤<br>
                    <span class="var-v">v¬≥</span> = Velocidad al cubo (m/s)
                </div>
            </div>
            <p><strong>Nota la matem√°tica:</strong> El impacto de la velocidad es exponencial (<span class="var-v">v¬≥</span>), el impacto del di√°metro es cuadr√°tico (al determinar el √Årea <span class="var-d">A</span>), y el impacto de la densidad (<span class="var-rho">œÅ</span>) es directamente proporcional y lineal.</p>
            <button class="btn-accion btn-siguiente" onclick="reveal('bloque-3', this)">Siguiente: Limitaciones F√≠sicas ‚ûî</button>
        </div>

        <div class="segmented-block" id="bloque-3">
            <h2>3. Limitaciones F√≠sicas: El L√≠mite de Betz</h2>
            <p>La f√≥rmula anterior calcula la <span class="var-p">Potencia Te√≥rica total</span> disponible en el viento. Sin embargo, por leyes de la aerodin√°mica y la conservaci√≥n de masa, un aerogenerador no puede absorber el 100% de esa energ√≠a. Si lo hiciera, el viento se detendr√≠a por completo detr√°s de las aspas, impidiendo el ingreso de viento nuevo.</p>
            
            <div style="background: #F3E5F5; border-left: 4px solid var(--color-betz); padding: 1rem; margin: 1rem 0; border-radius: 4px;">
                <p>El f√≠sico Albert Betz demostr√≥ en 1919 el <strong>L√≠mite de Betz</strong>: establece que la <span class="var-betz">Potencia √ötil M√°xima</span> que puede extraer cualquier turbina e√≥lica, por perfecta que sea, es exactamente el <strong>16/27 (o 59.3%)</strong> de la potencia te√≥rica bruta.</p>
            </div>
            
            <div style="text-align: right; margin-top: 2rem;">
                <button class="btn-accion btn-primario" onclick="nav(3)">Ir al Simulador Interactivo ‚ûî</button>
            </div>
        </div>
    </section>

    <!-- PANTALLA 3: SIMULADOR -->
    <section id="s3" class="screen">
        <h1>Simulador Interactivo</h1>
        <p style="margin-bottom: 1.5rem;">Ajusta los par√°metros para observar c√≥mo var√≠a la potencia generada. Luego, guarda dos configuraciones distintas para compararlas.</p>
        
        <div class="controls-grid">
            <div class="control-item" style="border-top-color: var(--color-v);">
                <label class="var-v">Velocidad (v): <span id="val-v">5.0</span> m/s</label>
                <input type="range" id="in-v" min="3" max="20" step="0.5" value="5" oninput="simUpdate('v')">
            </div>
            <div class="control-item" style="border-top-color: var(--color-rho);">
                <label class="var-rho">Densidad (œÅ): <span id="val-rho">1.225</span> kg/m¬≥</label>
                <input type="range" id="in-rho" min="0.9" max="1.3" step="0.005" value="1.225" oninput="simUpdate('rho')">
            </div>
            <div class="control-item" style="border-top-color: var(--color-d);">
                <label class="var-d">Di√°metro (D): <span id="val-d">40</span> m</label>
                <input type="range" id="in-d" min="20" max="120" step="2" value="40" oninput="simUpdate('d')">
            </div>
        </div>

        <div class="feedback-dinamico" id="sim-feedback">
            ‚ÑπÔ∏è Mueve los controles para observar el impacto f√≠sico de cada variable en la potencia.
        </div>

        <div class="outputs-container">
            <div class="output-card out-p">
                <h3 class="var-p">Potencia Te√≥rica Bruta</h3>
                <div class="val-gigante var-p"><span id="out-p">0.0</span> kW</div>
                <p style="font-size: 0.9rem; color: #555;">Energ√≠a total en el aire</p>
            </div>
            <div class="output-card out-betz">
                <h3 class="var-betz">Potencia √ötil M√°xima</h3>
                <div class="val-gigante var-betz"><span id="out-betz">0.0</span> kW</div>
                <p style="font-size: 0.9rem; color: #555;">Aplicando L√≠mite de Betz (59.3%)</p>
            </div>
        </div>

        <div class="visualizer">
            <svg viewBox="0 0 400 300" style="width:100%; height:100%;">
                <!-- Suelo -->
                <rect x="0" y="280" width="400" height="20" fill="#E0E0E0"/>
                
                <!-- Poste elevado y posicionado correctamente (Punta en y=120) -->
                <polygon points="190,280 210,280 203,120 197,120" fill="#9E9E9E"/>
                
                <!-- Transformaci√≥n fija a la punta de la torre -->
                <g transform="translate(200, 120)">
                    <circle id="vis-area" cx="0" cy="0" r="40" fill="rgba(245, 124, 0, 0.1)" stroke="var(--color-d)" stroke-dasharray="4"/>
                    
                    <g id="vis-rotor">
                        <animateTransform id="anim-rotor" attributeName="transform" type="rotate" from="0 0 0" to="360 0 0" dur="2s" repeatCount="indefinite" />
                        <!-- Aspas simplificadas para el simulador -->
                        <line x1="0" y1="0" x2="0" y2="-40" stroke="#424242" stroke-width="5" stroke-linecap="round" id="b1"/>
                        <line x1="0" y1="0" x2="34.6" y2="20" stroke="#424242" stroke-width="5" stroke-linecap="round" id="b2"/>
                        <line x1="0" y1="0" x2="-34.6" y2="20" stroke="#424242" stroke-width="5" stroke-linecap="round" id="b3"/>
                    </g>
                    <!-- Eje central -->
                    <circle cx="0" cy="0" r="6" fill="#1F3A5F"/>
                </g>
                
                <g stroke="var(--color-v)" stroke-width="2" opacity="0.5" stroke-dasharray="10 5">
                    <line x1="20" y1="80" x2="100" y2="80" id="w1"><animate attributeName="x1" values="0;150;300" dur="2s" repeatCount="indefinite"/></line>
                    <line x1="20" y1="130" x2="100" y2="130" id="w2"><animate attributeName="x1" values="-50;100;250" dur="2s" repeatCount="indefinite"/></line>
                    <line x1="20" y1="180" x2="100" y2="180" id="w3"><animate attributeName="x1" values="-20;130;280" dur="2s" repeatCount="indefinite"/></line>
                </g>
            </svg>
        </div>

        <div style="text-align: center; margin-top: 1.5rem;">
            <button class="btn-accion btn-siguiente" onclick="saveState('A')">üíæ Guardar Configuraci√≥n A</button>
            <button class="btn-accion btn-siguiente" onclick="saveState('B')">üíæ Guardar Configuraci√≥n B</button>
            <span id="save-msg" style="margin-left: 10px; font-weight: bold; color: var(--color-rho);"></span>
        </div>

        <div class="active-learning-box" id="active-learning" style="display: none;">
            <h2 style="margin-top: 0;">üìä Interpreta los resultados</h2>
            <table>
                <tr>
                    <th>Escenario</th>
                    <th class="var-v">Velocidad (m/s)</th>
                    <th class="var-rho">Densidad (kg/m¬≥)</th>
                    <th class="var-d">Di√°metro (m)</th>
                    <th class="var-betz">Potencia √ötil (kW)</th>
                </tr>
                <tr>
                    <td><strong>Config. A</strong></td>
                    <td id="tbl-v-a">-</td><td id="tbl-rho-a">-</td><td id="tbl-d-a">-</td><td id="tbl-p-a" class="var-betz">-</td>
                </tr>
                <tr>
                    <td><strong>Config. B</strong></td>
                    <td id="tbl-v-b">-</td><td id="tbl-rho-b">-</td><td id="tbl-d-b">-</td><td id="tbl-p-b" class="var-betz">-</td>
                </tr>
            </table>

            <div style="margin-top: 2rem;">
                <p><strong>1. Al observar la tabla y jugar con el simulador, ¬øpor qu√© la velocidad domina el rendimiento general?</strong></p>
                <button class="opt-btn" style="width: 100%; margin: 5px 0;" onclick="checkAl(this, 1, true)">A) Porque en el modelo matem√°tico est√° elevada al cubo (v¬≥).</button>
                <button class="opt-btn" style="width: 100%; margin: 5px 0;" onclick="checkAl(this, 1, false)">B) Porque la velocidad modifica f√≠sicamente el l√≠mite de Betz.</button>
                <div id="fb-al-1" class="feedback-inline"></div>
            </div>

            <div style="margin-top: 1.5rem;">
                <p><strong>2. ¬øQu√© variable produce un efecto estrictamente proporcional y lineal en la potencia?</strong></p>
                <button class="opt-btn" style="width: 100%; margin: 5px 0;" onclick="checkAl(this, 2, false)">A) El di√°metro del rotor (D).</button>
                <button class="opt-btn" style="width: 100%; margin: 5px 0;" onclick="checkAl(this, 2, true)">B) La densidad del aire (œÅ).</button>
                <div id="fb-al-2" class="feedback-inline"></div>
            </div>

            <div style="margin-top: 1.5rem;">
                <p><strong>3. ¬øQu√© principio f√≠sico impide que extraigamos la "Potencia Te√≥rica Bruta" mostrada en rojo?</strong></p>
                <button class="opt-btn" style="width: 100%; margin: 5px 0;" onclick="checkAl(this, 3, false)">A) El principio de conservaci√≥n de masa puramente.</button>
                <button class="opt-btn" style="width: 100%; margin: 5px 0;" onclick="checkAl(this, 3, true)">B) El L√≠mite de Betz, que topa la eficiencia al 59.3% para permitir la salida del viento.</button>
                <div id="fb-al-3" class="feedback-inline"></div>
            </div>

            <div style="text-align: right; margin-top: 2rem;">
                <button class="btn-accion btn-continuar" onclick="nav(4)">Continuar al Resumen ‚ûî</button>
            </div>
        </div>
    </section>

    <!-- PANTALLA 4: RESUMEN -->
    <section id="s4" class="screen">
        <h1>Resumen y Comprensi√≥n de Conceptos</h1>
        
        <div class="resumen-box">
            <h2 style="margin-top: 0; color: #2E7D32;">üìå Conclusiones Clave</h2>
            <p>Tras revisar la teor√≠a y experimentar en el simulador, podemos consolidar las siguientes reglas fundamentales de la energ√≠a e√≥lica:</p>
            <ul>
                <li>La <strong class="var-v">Velocidad del viento</strong> es el rey de la generaci√≥n. Un aumento marginal en el viento genera un salto enorme en la potencia debido a su <strong>relaci√≥n c√∫bica</strong>.</li>
                <li>El <strong class="var-d">Tama√±o de las aspas</strong> (Di√°metro) tiene un <strong>impacto cuadr√°tico</strong>. Por eso, las turbinas modernas son cada vez m√°s grandes y altas.</li>
                <li>La <strong class="var-rho">Densidad del aire</strong> tiene un <strong>impacto lineal</strong>. Sitios fr√≠os y a nivel del mar producen ligeramente m√°s energ√≠a que sitios c√°lidos y altos con el mismo viento.</li>
                <li>La f√≠sica impone un techo: El <strong class="var-betz">L√≠mite de Betz (59.3%)</strong> nos recuerda que ning√∫n aerogenerador podr√° extraer toda la energ√≠a.</li>
            </ul>
        </div>

        <h3>‚úÖ Comprueba tu aprendizaje final</h3>
        <p style="margin-bottom: 1.5rem;">Resuelve este √∫ltimo escenario de an√°lisis:</p>

        <div class="pregunta-diag">
            <p><strong>Situaci√≥n:</strong> Eres un ingeniero y debes elegir el sitio para un nuevo parque e√≥lico. Tienes presupuesto limitado. ¬øEn qu√© invertir√≠as principalmente?</p>
            <div class="opciones-diag">
                <button class="opt-btn" onclick="checkDiag(this, 'final1', false, 'Incorrecto. Aunque la densidad ayuda, su impacto es lineal. Perder√°s la ventaja exponencial del viento.')">A) Buscar una zona extremadamente fr√≠a (aire denso) aunque el viento sea moderado.</button>
                <button class="opt-btn" onclick="checkDiag(this, 'final1', true, '¬°Correcto! Como ingeniero e√≥lico, tu prioridad #1 es la velocidad del viento por su efecto multiplicador (c√∫bico) en la potencia.')">B) Buscar la zona con la mayor velocidad de viento promedio posible, y adquirir las turbinas con mayor di√°metro que permita el presupuesto.</button>
                <button class="opt-btn" onclick="checkDiag(this, 'final1', false, 'Incorrecto. Reducir el di√°metro disminuye el √°rea de captaci√≥n de forma cuadr√°tica. Perder√°s mucha potencia.')">C) Comprar turbinas de di√°metro muy peque√±o para ahorrar, sin importar mucho d√≥nde colocarlas.</button>
            </div>
            <div id="fb-diag-final1" class="feedback-inline"></div>
        </div>

        <div style="text-align: right; margin-top: 2rem;">
            <button class="btn-accion btn-primario" onclick="nav(5)">Ver Detalles T√©cnicos (Acerca del OA) ‚ûî</button>
        </div>
    </section>

    <!-- PANTALLA 5: ACERCA DEL OA -->
    <section id="s5" class="screen">
        <h1>Acerca de este Objeto de Aprendizaje</h1>
        
        <div class="meta-box">
            <h3 style="margin-top: 0;">Metadatos</h3>
            <p><strong>Tema:</strong> Estimaci√≥n de potencia e√≥lica (F√≠sica/Ingenier√≠a).</p>
            <p><strong>P√∫blico Objetivo:</strong> Estudiantes universitarios / Nivel t√©cnico.</p>
            <p><strong>Requisitos t√©cnicos:</strong> Navegador web moderno (HTML5/CSS3/JS). No requiere LMS externo.</p>
        </div>

        <div class="meta-box" style="border-left-color: var(--color-rho);">
            <h3 style="margin-top: 0;">Fundamentaci√≥n Pedag√≥gica</h3>
            <p>Este OA fue dise√±ado aplicando estrictamente <strong>Principios de Aprendizaje Multimedia (Mayer)</strong>:</p>
            <ul style="margin-left: 1.5rem; margin-top: 0.5rem;">
                <li><strong>Representaci√≥n M√∫ltiple:</strong> Uso de ilustraciones vectoriales que apoyan cognitivamente al texto.</li>
                <li><strong>Segmentaci√≥n Cognitiva:</strong> Teor√≠a dividida en bloques progresivos.</li>
                <li><strong>Se√±alizaci√≥n y Coherencia:</strong> C√≥digo de color estricto entre variables y gr√°ficas.</li>
                <li><strong>Contig√ºidad Espacial:</strong> F√≥rmulas junto a sus explicaciones correspondientes.</li>
                <li><strong>Aprendizaje Activo:</strong> Tests diagn√≥sticos, simulaci√≥n interactiva y evaluaci√≥n de casos pr√°cticos.</li>
            </ul>
        </div>
    </section>

    <!-- ATRIBUCI√ìN SOLICITADA EXACTA Y √öNICA -->
    <footer>
        &copy; Elaborado por Dr. M. Linkimer
    </footer>

</div>

<script>
    function nav(s) {
        document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
        document.getElementById('s' + s).classList.add('active');
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active-tab'));
        document.getElementById('tab-' + s).classList.add('active-tab');
        document.getElementById('progress').innerText = `Paso ${s} de 5`;
        window.scrollTo(0, 0);
    }

    function checkDiag(btn, q, isCorrect, msg) {
        const container = btn.parentElement;
        container.querySelectorAll('button').forEach(b => {
            b.style.background = 'white'; b.style.borderColor = 'var(--borde)';
        });
        
        const fb = document.getElementById('fb-diag-' + q);
        fb.style.display = 'block';
        fb.innerHTML = msg;
        
        if(isCorrect) {
            btn.style.background = '#E8F5E9'; btn.style.borderColor = '#4CAF50';
            fb.className = 'feedback-inline fb-correcto';
        } else {
            btn.style.background = '#FFEBEE'; btn.style.borderColor = '#F44336';
            fb.className = 'feedback-inline fb-incorrecto';
        }
    }

    function reveal(id, btn) {
        document.getElementById(id).classList.add('visible');
        btn.style.display = 'none';
    }

    // SIMULADOR
    let prevStates = {v: 5, rho: 1.225, d: 40};
    const savedConfigs = { A: null, B: null };

    function simUpdate(changedVar) {
        const v = parseFloat(document.getElementById('in-v').value);
        const rho = parseFloat(document.getElementById('in-rho').value);
        const d = parseFloat(document.getElementById('in-d').value);
        
        const r = d / 2;
        const area = Math.PI * Math.pow(r, 2);
        const pTheo = 0.5 * rho * area * Math.pow(v, 3);
        const pBetz = pTheo * 0.593;

        document.getElementById('val-v').innerText = v.toFixed(1);
        document.getElementById('val-rho').innerText = rho.toFixed(3);
        document.getElementById('val-d').innerText = d.toFixed(0);
        document.getElementById('out-p').innerText = (pTheo / 1000).toFixed(1);
        document.getElementById('out-betz').innerText = (pBetz / 1000).toFixed(1);

        const fbBox = document.getElementById('sim-feedback');
        if (changedVar === 'v') {
            if (v > prevStates.v) fbBox.innerHTML = `üí® <strong>Incremento de Velocidad:</strong> Observa c√≥mo la potencia crece velozmente. La relaci√≥n c√∫bica (v¬≥) causa un gran impacto.`;
            else fbBox.innerHTML = `üìâ <strong>Ca√≠da de Velocidad:</strong> Una ligera ca√≠da del viento disminuye severamente la potencia generada.`;
        } else if (changedVar === 'rho') {
            fbBox.innerHTML = `‚òÅÔ∏è <strong>Densidad Modificada:</strong> Este cambio es lineal. Un aire m√°s denso transfiere m√°s energ√≠a a las aspas de forma directa.`;
        } else if (changedVar === 'd') {
            fbBox.innerHTML = `‚öôÔ∏è <strong>Di√°metro Ajustado:</strong> Al crecer el di√°metro, el √°rea de captaci√≥n aumenta al cuadrado (D¬≤). Absorbes viento de una zona m√°s amplia.`;
        }
        prevStates = {v, rho, d};

        // Reducci√≥n del factor visual para evitar que en el m√°ximo di√°metro roce el suelo.
        const visR = d * 1.2; 
        document.getElementById('vis-area').setAttribute('r', visR);
        
        const angle = 120 * (Math.PI / 180);
        document.getElementById('b1').setAttribute('y2', -visR);
        document.getElementById('b2').setAttribute('x2', visR * Math.sin(angle));
        document.getElementById('b2').setAttribute('y2', -visR * Math.cos(angle));
        document.getElementById('b3').setAttribute('x2', visR * Math.sin(-angle));
        document.getElementById('b3').setAttribute('y2', -visR * Math.cos(-angle));

        const speed = Math.max(0.3, 15 / v); 
        document.getElementById('anim-rotor').setAttribute('dur', speed + 's');
        
        const wSpeed = Math.max(0.5, 10 / v);
        document.querySelectorAll('animate').forEach(el => el.setAttribute('dur', wSpeed + 's'));
    }

    function saveState(id) {
        const v = parseFloat(document.getElementById('in-v').value);
        const rho = parseFloat(document.getElementById('in-rho').value);
        const d = parseFloat(document.getElementById('in-d').value);
        const area = Math.PI * Math.pow(d/2, 2);
        const pBetz = (0.5 * rho * area * Math.pow(v, 3) * 0.593) / 1000;

        savedConfigs[id] = { v, rho, d, pBetz };
        
        document.getElementById(`tbl-v-${id.toLowerCase()}`).innerText = v.toFixed(1);
        document.getElementById(`tbl-rho-${id.toLowerCase()}`).innerText = rho.toFixed(3);
        document.getElementById(`tbl-d-${id.toLowerCase()}`).innerText = d.toFixed(0);
        document.getElementById(`tbl-p-${id.toLowerCase()}`).innerText = pBetz.toFixed(1);

        const msg = document.getElementById('save-msg');
        msg.innerText = `‚úî Configuraci√≥n ${id} guardada.`;
        setTimeout(() => msg.innerText = '', 2000);

        if(savedConfigs.A && savedConfigs.B) {
            document.getElementById('active-learning').style.display = 'block';
        }
    }

    function checkAl(btn, q, isCorrect) {
        const container = btn.parentElement;
        container.querySelectorAll('button').forEach(b => {
            b.style.background = 'white'; b.style.borderColor = 'var(--borde)';
        });
        
        const fb = document.getElementById('fb-al-' + q);
        fb.style.display = 'block';
        
        let msg = "";
        if(q === 1) msg = isCorrect ? "¬°Correcto! En la f√≥rmula, v est√° elevada a la potencia de 3." : "Incorrecto. El l√≠mite de Betz es constante (59.3%), la velocidad afecta a la energ√≠a cin√©tica bruta.";
        if(q === 2) msg = isCorrect ? "¬°Exacto! œÅ no tiene exponente, su relaci√≥n es lineal." : "Incorrecto. El di√°metro afecta al √°rea, la cual eleva el radio al cuadrado (crecimiento cuadr√°tico).";
        if(q === 3) msg = isCorrect ? "¬°Perfecto! El l√≠mite de Betz define la m√°xima eficiencia aerodin√°mica." : "Incorrecto. No es solo conservaci√≥n de masa, es la necesidad de que el flujo de aire atraviese y salga del rotor.";

        fb.innerHTML = msg;
        
        if(isCorrect) {
            btn.style.background = '#E8F5E9'; btn.style.borderColor = '#4CAF50';
            fb.className = 'feedback-inline fb-correcto';
        } else {
            btn.style.background = '#FFEBEE'; btn.style.borderColor = '#F44336';
            fb.className = 'feedback-inline fb-incorrecto';
        }
    }

    simUpdate('init');
</script>

</body>
</html>
